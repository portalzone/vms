# ----------------------------------------------------------------------
# STAGE 1: BUILD (For compiling Vue/Vite assets)
# ----------------------------------------------------------------------
FROM node:20-alpine AS frontend_builder

# Set the working directory inside the container to where the Vue project will live
# This is crucial: the path inside the container must match where NPM expects to work.
WORKDIR /app/vms-frontend/vue-project

# Copy package files into the new working directory
# NOTE: The *context* (first part) is the path on your host machine.
# The *destination* (second part) is the path in the container.
COPY package.json ./
COPY package-lock.json ./

# Install Node dependencies
RUN npm install

# Copy the entire Vue source code (including src/, public/, vite.config.js, etc.)
COPY vms-frontend/vue-project/ ./

# Run the production build (Vite/Rollup)
# This generates the compiled assets in the expected output directory (often 'dist')
RUN npm run build
